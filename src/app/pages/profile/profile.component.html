<div class="profile-container">
  <div *ngIf="dataLoading" class="spinner">
      <span>Loading...</span>
    </div>
  <div class="profile-left">
    <div class="user-info">
      <h2>{{ profile?.firstName }} {{ profile?.lastName }}</h2>
      <p>Email: {{ profile?.email }}</p>
      <div *ngIf="isDoctor">
        <p>Especialización: {{ getDoctorProfile()?.specialization }}</p>
        <p>Licencia: {{ getDoctorProfile()?.licenseNumber }}</p>
        <p>Precio/Hora: €{{ getDoctorProfile()?.priceHour }}</p>
      </div>
      <button>Cambiar contraseña</button>
    </div>
    <div class="appointments-today">
      <h3>Citas para hoy</h3>
      <div *ngFor="let appointment of todaysAppointments">
        <div class="event">
          <span *ngIf="!isDoctor">{{ appointment.doctorEmail }}</span>
          <span *ngIf="isDoctor">{{ appointment.patientEmail }}</span>
          <br><span>{{ appointment.sessionType }}</span>
          <br><span>{{ appointment.appointmentDate | date:'HH:mm' }}</span>
          <button *ngIf="appointment.room" (click)="openUrl(appointment.id)">Abrir URL</button>
        </div>
      </div>
    </div>
  </div>


  <div class="profile-right">
    <div *ngIf="!dataLoading">
      <div class="calendar">
        <div class="calendar-header">
          <button (click)="prevMonth()">&#9664;</button>
          <h2>{{ currentDate.toLocaleString('es-ES', { month: 'long', year: 'numeric' }) }}</h2>
          <button (click)="nextMonth()">&#9654;</button>
        </div>

        <div class="calendar-grid">
          <div class="day">Lunes</div>
          <div class="day">Martes</div>
          <div class="day">Miércoles</div>
          <div class="day">Jueves</div>
          <div class="day">Viernes</div>
          <div class="day">Sábado</div>
          <div class="day">Domingo</div>

          <ng-container *ngFor="let day of calendarDays">
            <div *ngIf="day.number !== 0" class="day-number">
              {{ day.number }}
              <div *ngFor="let appointment of day.appointments" class="event"
                   [ngClass]="appointment.status === 'futura' ? 'event-green' : 'event-gray'"
                  >
                <div class="event-details">
                  <span *ngIf="!isDoctor">{{ appointment.doctorEmail }}</span>
                  <span *ngIf="isDoctor">{{ appointment.patientEmail }}</span>
                  <br><span>{{ appointment.sessionType }}</span>
                  <br><span>{{ appointment.appointmentDate | date:'HH:mm' }}</span>
                </div>
                <div class="event-buttons">
                  <button (click)="deleteAppointment(appointment.id)">
                    <span><img src="https://img.icons8.com/material-rounded/24/filled-trash.png" alt="" width="20" height="20"></span>
                  </button>
                </div>
              </div>
            </div>
            <div *ngIf="day.number === 0" class="empty"></div>
          </ng-container>
          
        </div>
      </div>
    </div>
  </div>
</div>